---
title: "Exploratory Data Analysis of School Shooting Data"
author: "Melissa Juarez"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document; pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Research Question: Using a logit model, how do X, Y, and Z variables affect the likelihood that there will be a victim in a school shooting incident?

-   age, gender, and school affiliation of shooter
-   whether there were any victims targets or random
-   whether any shooter was bullied
-   whether shooter has instances of domestic violence
-   preplanned?
-   school level
-   during schoo
-   

```{r}
library(here)
library(readxl)
library(dplyr)
library(ggplot2)

## source functions and variables from prior scripts
source(here::here("code/functions.R"))
source(here::here("code/01_tidy.R"))
```


## Visualizing Missingness in Variables across all datasets

The goal of this project is identify variables of interest that might help us understand the likelihood of a shooting incident resulting in a victim. The incidents in the dataset span over a time frame of 40 years, and we first should look at the missingness across variables in our dataset to assess the viability of using certain variables in our model.

We'll visualize the missingness across each of the 4 datasets (incident_df, shooter_df, victim_df, weapon_df)

```{r}
library(naniar)

vis_miss(incident_df)
```

```{r}
vis_miss(shooter_df)
```

```{r}
vis_miss(victim_df)
```

```{r}
vis_miss(weapon_df)
```


## Exploring Dependent Variable
Our Dependent Variable will be victim counts, so let's explore the distribution of victim counts for school schootings 1970-2022.

```{r}
table(incident_df$victim_count)
ggplot(incident_df, aes(x=as.numeric(sub("%", "",victim_count,fixed=TRUE)))) + 
  geom_histogram(aes(y=..density..), color="darkblue", fill="lightblue", binwidth = 1) + 
  geom_density(alpha=.2, fill="#FF6666") +
  geom_vline(aes(xintercept=median(as.numeric(sub("%", "",victim_count,fixed=TRUE)))),
             color="black", linetype="dashed", size=0.5) +
  labs(title="Distribution of Victim Count for School Shooting resulting in more than 1 victim",
       x ="Victim Count", y = "Density")
```

Most school shooting between 1970-2022 between 0 and 2 victims.


## POSSIBLE INDEPENDENT VARIABLES

### school level

```{r}
one_var_tabyl(incident_df, school_level) %>% k()
```


### XX 

```{r}
one_var_tabyl(incident_df, school_level) %>% k()
```

